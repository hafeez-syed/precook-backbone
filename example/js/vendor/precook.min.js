(function(){var e,t;t=typeof exports!="undefined"&&exports!==null?exports:this,e=function(){function e(){}return _.extend(e.prototype,Backbone.Events),e.prototype._sourceFile="",e.prototype.setSourceFile=function(e){this._sourceFile=e},e.prototype.load=function(){var e=this;return this.image=new Image,$(this.image).bind("load error",function(t){return e.complete()}),this.image.src=this._sourceFile,this._checkCached()},e.prototype._checkCached=function(){if(this.image.complete||this.image.complete===void 0)return this.complete()},e.prototype.complete=function(){return $(this.image).unbind(),this.trigger("asset:completed")},e}(),t.PrecookImage=e}).call(this),function(){var e,t,n=[].slice,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=typeof exports!="undefined"&&exports!==null?exports:this,e={"_config":null,"_loaders":{"image":function(){return new PrecookImage},"video":function(){return new PrecookVideo}},"_types":{"image":["png","jpg","jpeg","gif"],"video":["mp4","webm","ogv"]},"_assets":[],"_toLoad":[],"_numToLoad":0,"_numLoaded":0,"_group":null,"_groups":[],"setConfig":function(e){var t,n=this;if(_.isObject(e))return this._configFromObject(e);t=$.getJSON(e),t.done(function(e,t){if(e.GROUPS==null)throw new Error("Invalid JSON format passed to the preloader configuration.");return n._config=e,n.trigger("preloader:configLoaded")}),t.fail(function(e,t){return n.trigger("preloader:configLoaded")})},"load":function(){var e,t,r,i,s,o,u,a,f,l,c,h,p;r=1<=arguments.length?n.call(arguments,0):[];if(this._config==null)return this._finished();for(i=0,u=r.length;i<u;i++){t=r[i];if(this._config.GROUPS[t]==null)throw new Error("Invalid group passed to preloader.");this._groups.push(this._config.GROUPS[t])}this._group=r[0],this._groups=(l=[]).concat.apply(l,this._groups),c=this._groups;for(s=0,a=c.length;s<a;s++)e=c[s],this._addAsset(e);h=this._toLoad,p=[];for(o=0,f=h.length;o<f;o++)e=h[o],p.push(this._startLoader(e));return p},"_configFromObject":function(e){return this._config=e,this.trigger("preloader:configLoaded")},"_resetLoader":function(){var e,t,n,r;r=this._toLoad;for(t=0,n=r.length;t<n;t++)e=r[t],this._removeAsset(e);return this._toLoad=[],this._numToLoad=this._numLoaded=0,this._group=null,this._groups=[]},"_removeAsset":function(e){return e.off("asset:completed"),e=null},"_addAsset":function(e){var t,n;n=this._determineType(e);if(!n)throw new Error("Unable to determine asset type for "+e);return t=this._getLoader(n),t.setSourceFile(this._config.BASE_URL+e),this._toLoad.push(t),this._numToLoad+=1},"_determineType":function(e){var t,n,i,s;t=e.substr(e.lastIndexOf(".")+1,e.length),s=this._types;for(i in s){n=s[i];if(r.call(n,t)>=0)return i}return!1},"_getLoader":function(e){return this._loaders[e]()},"_startLoader":function(e){var t=this;return e.on("asset:completed",function(){return t._numLoaded+=1,t._checkFinished()}),e.load()},"_checkFinished":function(){if(this._numToLoad===this._numLoaded)return this._finished()},"_finished":function(){var e;return e=this._group,this._resetLoader(),this.trigger("preloader:completed",e)}},_.extend(e,Backbone.Events),t.Precook=e}.call(this),function(){var e,t;t=typeof exports!="undefined"&&exports!==null?exports:this,e=function(){function e(){}return _.extend(e.prototype,Backbone.Events),e.prototype._sourceFile="",e.prototype.setSourceFile=function(e){return Modernizr.video.webm?e=this._swapExtension(e,"webm"):Modernizr.video.h264?e=this._swapExtension(e,"mp4"):Modernizr.video.ogg&&(e=this._swapExtension(e,"ogv")),this._sourceFile=e},e.prototype._swapExtension=function(e,t){var n;return n=e.substr(0,e.lastIndexOf(".")),""+n+"."+t},e.prototype.load=function(){var e=this;return this.video=$("<video/>",{"src":this._sourceFile,"preload":"auto"}),$(this.video).bind("canplaythrough load error",function(t){return e.complete()})},e.prototype.complete=function(){return $(this.video).unbind(),this.trigger("asset:completed")},e}(),t.PrecookVideo=e}.call(this);