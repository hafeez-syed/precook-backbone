(function(){var e,t;t=typeof exports!="undefined"&&exports!==null?exports:this,e=function(){function e(){}return _.extend(e.prototype,Backbone.Events),e.prototype._sourceFile="",e.prototype.setSourceFile=function(e){this._sourceFile=e},e.prototype.load=function(){var e=this;return this.image=new Image,$(this.image).bind("load error",function(t){return e.complete()}),this.image.src=this._sourceFile,this._checkCached()},e.prototype._checkCached=function(){if(this.image.complete||this.image.complete===void 0)return this.complete()},e.prototype.complete=function(){return $(this.image).unbind(),this.trigger("asset:completed")},e}(),t.PrecookImage=e}).call(this),function(){var e,t,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=typeof exports!="undefined"&&exports!==null?exports:this,e={"_config":null,"_loaders":{"image":function(){return new PrecookImage},"video":function(){return new PrecookVideo}},"_types":{"image":["png","jpg","jpeg","gif"],"video":["mp4","webm","ogv"]},"_assets":[],"_toLoad":[],"_numToLoad":0,"_numLoaded":0,"_group":null,"setConfig":function(e){var t,n=this;if(_.isObject(e))return this._configFromObject(e);t=$.getJSON(e),t.done(function(e,t){if(e.GROUPS==null)throw new Error("Invalid JSON format passed to the preloader configuration.");return n._config=e,n.trigger("preloader:configLoaded")}),t.fail(function(e,t){return n.trigger("preloader:configLoaded")})},"load":function(e){var t,n,r,i,s,o,u,a;this._group=e;if(this._config==null)return this._finished();if(this._config.GROUPS[this._group]==null)throw new Error("Invalid group passed to preloader.");o=this._config.GROUPS[this._group];for(n=0,i=o.length;n<i;n++)t=o[n],this._addAsset(t);u=this._toLoad,a=[];for(r=0,s=u.length;r<s;r++)t=u[r],a.push(this._startLoader(t));return a},"_configFromObject":function(e){return this._config=e,this.trigger("preloader:configLoaded")},"_resetLoader":function(){var e,t,n,r;r=this._toLoad;for(t=0,n=r.length;t<n;t++)e=r[t],this._removeAsset(e);return this._toLoad=[],this._numToLoad=this._numLoaded=0,this._group=null},"_removeAsset":function(e){return e.off("asset:completed"),e=null},"_addAsset":function(e){var t,n;n=this._determineType(e);if(!n)throw new Error("Unable to determine asset type for "+e);return t=this._getLoader(n),t.setSourceFile(this._config.BASE_URL+e),this._toLoad.push(t),this._numToLoad+=1},"_determineType":function(e){var t,r,i,s;t=e.substr(e.lastIndexOf(".")+1,e.length),s=this._types;for(i in s){r=s[i];if(n.call(r,t)>=0)return i}return!1},"_getLoader":function(e){return this._loaders[e]()},"_startLoader":function(e){var t=this;return e.on("asset:completed",function(){return t._numLoaded+=1,t._checkFinished()}),e.load()},"_checkFinished":function(){if(this._numToLoad===this._numLoaded)return this._finished()},"_finished":function(){var e;return e=this._group,this._resetLoader(),this.trigger("preloader:completed",e)}},_.extend(e,Backbone.Events),t.Precook=e}.call(this),function(){var e,t;t=typeof exports!="undefined"&&exports!==null?exports:this,e=function(){function e(){}return _.extend(e.prototype,Backbone.Events),e.prototype._sourceFile="",e.prototype.setSourceFile=function(e){return Modernizr.video.webm?e=this._swapExtension(e,"webm"):Modernizr.video.h264?e=this._swapExtension(e,"mp4"):Modernizr.video.ogg&&(e=this._swapExtension(e,"ogv")),this._sourceFile=e},e.prototype._swapExtension=function(e,t){var n;return n=e.substr(0,e.lastIndexOf(".")),""+n+"."+t},e.prototype.load=function(){var e=this;return this.video=$("<video/>",{"src":this._sourceFile,"preload":"auto"}),$(this.video).bind("canplaythrough load error",function(t){return e.complete()})},e.prototype.complete=function(){return $(this.video).unbind(),this.trigger("asset:completed")},e}(),t.PrecookVideo=e}.call(this);