(function(){var t,e;e="undefined"!=typeof exports&&null!==exports?exports:this,t=function(){function t(){_.extend(this,Backbone.Events)}return t.prototype._sourceFile="",t.prototype.setSourceFile=function(t){this._sourceFile=t},t.prototype.load=function(){var t=this;return this.image=new Image,$(this.image).bind("load error",function(){return t.complete()}),this.image.src=this._sourceFile,this._checkCached()},t.prototype._checkCached=function(){return this.image.complete||void 0===this.image.complete?this.complete():void 0},t.prototype.complete=function(){return $(this.image).unbind(),this.trigger("asset:completed")},t}(),e.PrecookImage=t}).call(this),function(){var t,e,o=[].slice,r=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};e="undefined"!=typeof exports&&null!==exports?exports:this,t=function(){function t(){this._config=null,this._toLoad=[],this._numToLoad=0,this._numLoaded=0,this._group="",this._groups=[],_.extend(this,Backbone.Events)}var e,n,i,s,u,p,d,a;for(t.prototype._loaders={image:function(){return new PrecookImage},video:function(){return new PrecookVideo}},t.prototype._types={image:["png","jpg","jpeg","gif"],video:["mp4","webm","ogv"]},t.prototype.setConfig=function(t){var e,o=this;return _.isObject(t)?this._configFromObject(t):(e=$.getJSON(t),e.done(function(t){if(null==t.GROUPS)throw Error("Invalid JSON format passed to the preloader configuration.");return o._config=t,o.trigger("preloader:configLoaded")}),e.fail(function(){return o.trigger("preloader:configLoaded")}),void 0)},t.prototype.load=function(){var t,e,r,n;if(e=arguments.length>=1?o.call(arguments,0):[],null==this._config)return this._finished();for(r=0,n=e.length;n>r;r++)if(t=e[r],null==this._config.GROUPS[t])throw console.log("loading group",t,this._config.GROUPS),Error("Invalid group passed to preloader.");return this._groups.push(this._config.GROUPS[t])},t._group=groups[0],t._groups=(p=[]).concat.apply(p,t._groups),d=t._groups,n=0,s=d.length;s>n;n++)e=d[n],t._addAsset(e);for(a=t._toLoad,i=0,u=a.length;u>i;i++)e=a[i],t._startLoader(e);return t.prototype.newLoader=function(t){return this._loaders[t.type]=function(){return new t.loader},this._types[t.type]=t.types},t.prototype._configFromObject=function(t){return this._config=t,this.trigger("preloader:configLoaded")},t.prototype._resetLoader=function(){var t,o,r;for(r=this._toLoad,t=0,o=r.length;o>t;t++)e=r[t],this._removeAsset(e);return this._toLoad=[],this._numToLoad=this._numLoaded=0,this._group=null,this._groups=[]},t.prototype._removeAsset=function(t){return t.off("asset:completed"),t=null},t.prototype._addAsset=function(t){var e,o,r;if(o=this._determineType(t),!o)throw Error("Unable to determine asset type for "+t);return e=this._getLoader(o),r=t,null!=this._config.BASE_URL&&(r=this._config.BASE_URL+r),e.setSourceFile(r),this._toLoad.push(e),this._numToLoad+=1},t.prototype._determineType=function(t){var e,o,n,i;e=t.substr(t.lastIndexOf(".")+1,t.length),i=this._types;for(n in i)if(o=i[n],r.call(o,e)>=0)return n;return!1},t.prototype._getLoader=function(t){return this._loaders[t]()},t.prototype._startLoader=function(t){var e=this;return t.on("asset:completed",function(){return e._numLoaded+=1,e._checkFinished()}),t.load()},t.prototype._checkFinished=function(){return console.log("finished?",this._numToLoad,"is",this._numLoaded),this._numToLoad===this._numLoaded?this._finished():void 0},t.prototype._finished=function(){var t;return t=this._group,this._resetLoader(),this.trigger("preloader:completed",t)},t}(),e.Precook=t}.call(this),function(){var t,e;e="undefined"!=typeof exports&&null!==exports?exports:this,t=function(){function t(){_.extend(this,Backbone.Events)}return t.prototype._sourceFile="",t.prototype.setSourceFile=function(t){return Modernizr.video.webm?t=this._swapExtension(t,"webm"):Modernizr.video.h264?t=this._swapExtension(t,"mp4"):Modernizr.video.ogg&&(t=this._swapExtension(t,"ogv")),this._sourceFile=t},t.prototype._swapExtension=function(t,e){var o;return o=t.substr(0,t.lastIndexOf(".")),""+o+"."+e},t.prototype.load=function(){var t=this;return this.video=$("<video/>",{src:this._sourceFile,preload:"auto"}),$(this.video).bind("canplaythrough load error",function(){return t.complete()})},t.prototype.complete=function(){return $(this.video).unbind(),this.trigger("asset:completed")},t}(),e.PrecookVideo=t}.call(this);